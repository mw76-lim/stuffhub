<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>ë¬´ë£Œ ìŒì‹/ì¿ í° ë£°ë ›ê²Œì„ - ë¼ì˜¤ì¶©ì¹­í› ê¶ˆ</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      * { box-sizing: border-box; margin: 0; padding: 0; }

      body{
        min-height: 100vh;
        display: grid;
        place-items: center;
        gap: 12px;
        background: #f7f2ea;
        font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
        color: #3a2415;
        padding: 16px;
      }

      /* âœ… Fixed canvas: 600x450 */
      .game-shell{
        width: 600px;
        height: 450px;
        padding: 14px 14px 12px;
        background: #fffaf5;
        border-radius: 24px;
        box-shadow: 0 16px 40px rgba(120, 72, 37, 0.18);
        border: 1px solid rgba(193, 160, 120, 0.4);
        overflow: hidden;

        display: grid;
        grid-template-rows: auto 1fr auto;
        gap: 10px;
      }

      /* âœ… ìƒë‹¨ ë°”(íƒ€ì´í‹€ + ë¦¬ì…‹) */
      .topbar{
        display:flex;
        align-items:center;
        justify-content:space-between;
        gap: 10px;
      }

      .game-header{
        text-align:left;
        min-width:0;
      }
      .game-title{
        font-size: 18px;
        font-weight: 900;
        letter-spacing: -0.02em;
        white-space:nowrap;
        overflow:hidden;
        text-overflow:ellipsis;
      }

      .btn{
        padding: 10px 14px;
        font-size: 12px;
        font-weight: 900;
        border-radius: 999px;
        border: 1px solid rgba(148,104,63,.55);
        background: rgba(255,255,255,.85);
        color: #3a2415;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        transition: transform .12s ease, box-shadow .12s ease, opacity .12s ease;
        box-shadow: 0 10px 20px rgba(120,72,37,.12);
        white-space:nowrap;
      }
      .btn.primary{
        border: none;
        color: #fff;
        background: linear-gradient(120deg, #f97316, #fbbf24);
        box-shadow: 0 12px 26px rgba(201, 93, 39, 0.35);
      }
      .btn:hover:not([disabled]){ transform: translateY(-1px); }
      .btn[disabled]{ opacity: .55; cursor: default; transform: none; box-shadow: none; }

      .content-row{
        display: grid;
        align-items: center;
        justify-items: center;
        min-height: 0;
      }

      .wheel-wrap{
        position: relative;
        width: 260px;
        aspect-ratio: 1 / 1;
        margin: 0 auto;
      }

      .pointer{
        z-index: 2;
        position: absolute;
        top: -14px;
        left: 50%;
        transform: translateX(-50%) rotate(180deg);
        width: 0;
        height: 0;
        border-left: 12px solid transparent;
        border-right: 12px solid transparent;
        border-bottom: 18px solid #c95327;
        filter: drop-shadow(0 6px 10px rgba(0,0,0,.15));
      }

      .wheel{
        width: 100%;
        height: 100%;
        border-radius: 50%;
        border: 7px solid #f0e0ce;
        background: conic-gradient(
          #f97316 0deg 72deg,
          #facc15 72deg 144deg,
          #f9a8d4 144deg 216deg,
          #a5b4fc 216deg 252deg,
          #6ee7b7 252deg 288deg,
          #e5e7eb 288deg 360deg
        );
      }

      .wheel-inner{
        position: absolute;
        inset: 40%;
        border-radius: 50%;
        background: radial-gradient(circle at center, #fffaf5, #f3d7b3);
        display: flex;
        align-items: center;
        justify-content: center;
        pointer-events: none;
        font-weight: 900;
        color: rgba(58, 36, 21, 0.65);
      }

      .controls{
        display: grid;
        gap: 8px;
      }

      /* âœ… seed-buttons + spinButton ê°€ë¡œ ë°°ì¹˜ */
      .control-row{
        display:flex;
        align-items:center;
        justify-content:space-between;
        gap: 10px;
      }

      .seed-buttons{
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
        align-items:center;
        min-width:0;
      }

      .seed-buttons label{
        display:inline-flex;
        align-items:center;
        gap: 6px;
        font-size: 12px;
        color:#6b4a30;
      }

      .seed-btn{
        appearance: none;
        padding: 7px 10px;
        background: #fff;
        border-radius: 999px;
        border: 2px solid #c9a67a;
        cursor: pointer;
        font-size: 12px;
        transition: 0.2s ease;
      }

      .seed-btn:checked{
        background: #c9a67a;
        color: #fff;
        border-color: #c9a67a;
      }

      .game-result{
        text-align: center;
        font-size: 12px;
        color: #5a3a22;
        min-height: 18px;
      }
      .game-result strong{ color:#b45309; }

      /* âœ… ë²”ë¡€ ë°•ìŠ¤ (game-shell ì•„ë˜) */
      .legend-shell{
        width: 600px;
        background: rgba(255,250,245,.85);
        border-radius: 18px;
        border: 1px solid rgba(193, 160, 120, 0.35);
        box-shadow: 0 10px 26px rgba(120, 72, 37, 0.10);
        padding: 12px;
      }

      .legend-title{
        font-size: 12px;
        font-weight: 900;
        letter-spacing: -0.02em;
        color: #5a3a22;
        margin-bottom: 8px;
        display:flex;
        align-items:center;
        justify-content:space-between;
        gap: 8px;
      }
      .legend-title span{
        font-size: 11px;
        font-weight: 700;
        color: #7a5538;
        opacity: .9;
      }

      .game-legend{
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 8px;
        font-size: 11.5px;
      }

      .legend-item{
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 7px 8px;
        border-radius: 12px;
        background: #f4e5d1;
        line-height: 1.2;
      }

      .legend-color{
        width: 12px;
        height: 12px;
        border-radius: 50%;
        flex: 0 0 auto;
      }

      .c1 { background: #f97316; }
      .c2 { background: #facc15; }
      .c3 { background: #f9a8d4; }
      .c4 { background: #a5b4fc; }
      .c5 { background: #6ee7b7; }
      .c6 { background: #e5e7eb; }

      @media (max-width: 640px){
        body{ gap: 10px; }
        .game-shell{
          width: 100%;
          height: auto;
          min-height: 450px;
        }
        .legend-shell{ width: 100%; }
        .wheel-wrap{ width: 280px; }
        .game-legend{ grid-template-columns: 1fr; }

        .topbar{ flex-wrap:wrap; justify-content:center; }
        .game-header{ text-align:center; width:100%; }

        .control-row{ flex-direction:column; align-items:stretch; }
        #spinButton{ width:100%; }
        .seed-buttons{ justify-content:center; }
      }
    </style>
  </head>

  <body>
    <div class="game-shell">
      <!-- âœ… ìƒë‹¨: íƒ€ì´í‹€ + ë¦¬ì…‹ë²„íŠ¼ -->
      <div class="topbar">
        <header class="game-header">
          <h1 class="game-title">ë¬´ë£Œ ìŒì‹/ì¿ í° ë£°ë ›ê²Œì„</h1>
        </header>
        <button class="btn" id="resetButton" disabled>ê²Œì„ì´ˆê¸°í™” ğŸ”</button>
      </div>

      <div class="content-row">
        <div class="wheel-wrap">
          <div class="pointer"></div>
          <div class="wheel" id="wheel">
            <div class="wheel-inner">â†‘</div>
          </div>
        </div>
      </div>

      <div class="controls">
        <!-- âœ… seed-buttons + spinButton ê°€ë¡œë¡œ í•œ ì¤„ -->
        <div class="control-row" aria-label="ì‹œë“œ ë° ìŠ¤í•€">
          <div class="seed-buttons" aria-label="ì‹œë“œ ì„ íƒ">
            <label><input type="radio" name="seed" class="seed-btn" value="1" checked>1</label>
            <label><input type="radio" name="seed" class="seed-btn" value="2">2</label>
            <label><input type="radio" name="seed" class="seed-btn" value="3">3</label>
            <label><input type="radio" name="seed" class="seed-btn" value="4">4</label>
            <label><input type="radio" name="seed" class="seed-btn" value="5">5</label>
            <label><input type="radio" name="seed" class="seed-btn" value="6">6</label>
          </div>

          <button class="btn primary" id="spinButton">ë£°ë › ëŒë¦¬ê¸° ğŸ²</button>
        </div>

        <div class="game-result" id="resultText">ì‹œë“œ ë²ˆí˜¸ë¥¼ ì„ íƒí•˜ê³  ë£°ë ›ì„ ëŒë ¤ë³´ì„¸ìš”.</div>
      </div>
    </div>

    <div class="legend-shell" aria-label="ìƒí’ˆ ë²”ë¡€">
      <div class="legend-title">
        <div>ìƒí’ˆ ë²”ë¡€</div>
        <span>* í™•ë¥ ì€ ë‚´ë¶€ ì„¤ì • ê¸°ì¤€</span>
      </div>
      <div class="game-legend">
        <div class="legend-item"><span class="legend-color c1"></span> ìº” ìŒë£Œ 1ê°œ (20%)</div>
        <div class="legend-item"><span class="legend-color c2"></span> ë©´ë¥˜ 1ì ‘ì‹œ (20%)</div>
        <div class="legend-item"><span class="legend-color c3"></span> í¬ì¼“ í•«íŒ© (20%)</div>
        <div class="legend-item"><span class="legend-color c4"></span> ë‹¹ì¼ ë§Œì› í• ì¸ (10%)</div>
        <div class="legend-item"><span class="legend-color c5"></span> ì¬ë°©ë¬¸ 50% í• ì¸ (10%)</div>
        <div class="legend-item"><span class="legend-color c6"></span> ê½ (20%)</div>
      </div>
    </div>

    <script>
      (function () {
        const wheel = document.getElementById("wheel");

        const spinButton = document.getElementById("spinButton");
        const resetButton = document.getElementById("resetButton");
        const resultText = document.getElementById("resultText");
        const seedInputs = document.querySelectorAll("input[name='seed']");

        const prizes = [
          { label: "ê½", prob: 0.2, ds: 0,   de: 72 },
          { label: "ì¬ë°©ë¬¸ì‹œ 50% í• ì¸", prob: 0.1, ds: 72,  de: 108 },
          { label: "ë‹¹ì¼ ê²°ì œê¸ˆì•¡ ë§Œì› í• ì¸", prob: 0.1, ds: 108, de: 144 },
          { label: "í¬ì¼“ í•«íŒ©", prob: 0.2, ds: 144, de: 216 },
          { label: "ë©´ë¥˜ 1ì ‘ì‹œ", prob: 0.2, ds: 216, de: 288 },
          { label: "ìº” ìŒë£Œ 1ê°œ", prob: 0.2, ds: 288, de: 360 },
        ];

        const sectorAngles = [0, 72, 144, 216, 252, 288, 360];
        const pointerAngle = 90;

        let currentRotation = 0;
        let isSpinning = false;
        let hasResult = false;

        function getSeed() {
          return parseInt(document.querySelector("input[name='seed']:checked").value, 10);
        }

        function setSeedsDisabled(disabled){
          seedInputs.forEach(i => (i.disabled = disabled));
          seedInputs.forEach(i => {
            const label = i.closest("label");
            if (!label) return;
            label.style.opacity = disabled ? "0.65" : "1";
            label.style.cursor = disabled ? "default" : "pointer";
          });
        }

        function setUIState(state){
          // state: "ready" | "spinning" | "done"
          if (state === "ready"){
            spinButton.disabled = false;
            resetButton.disabled = true;
            setSeedsDisabled(false);
            hasResult = false;
            return;
          }
          if (state === "spinning"){
            spinButton.disabled = true;
            resetButton.disabled = true;
            setSeedsDisabled(true);
            return;
          }
          if (state === "done"){
            spinButton.disabled = true;
            resetButton.disabled = false;
            setSeedsDisabled(true);
            hasResult = true;
            return;
          }
        }

        function getSeededRandom(seed) {
          const base = Math.random();
          const offset = (seed - 1) / 6;
          return (base + offset) % 1;
        }

        function pickPrizeIndex(seed) {
          const r = getSeededRandom(seed);
          let acc = 0;
          for (let i = 0; i < prizes.length; i++) {
            acc += prizes[i].prob;
            if (r <= acc) return i;
          }
          return prizes.length - 1;
        }

        function whichPrizeByRotation(rot){
          const wheelDegree = ((Math.floor(rot) % 360) + 360) % 360;
          for (let i = 0; i < prizes.length; i++) {
            if (prizes[i].ds <= wheelDegree && wheelDegree < prizes[i].de) return prizes[i];
          }
          return prizes[0];
        }

        function resetGame(){
          isSpinning = false;
          currentRotation = 0;

          wheel.style.transition = "none";
          wheel.style.transform = "rotate(0deg)";
          wheel.offsetHeight;
          wheel.style.transition = "";

          resultText.textContent = "ì‹œë“œ ë²ˆí˜¸ë¥¼ ì„ íƒí•˜ê³  ë£°ë ›ì„ ëŒë ¤ë³´ì„¸ìš”.";
          setUIState("ready");
        }

        function spinWheel() {
          if (isSpinning || hasResult) return;

          const seed = getSeed();
          isSpinning = true;

          setUIState("spinning");
          resultText.textContent = "ë£°ë ›ì´ ëŒê³  ìˆì–´ìš”...";

          const index = pickPrizeIndex(seed);

          const start = sectorAngles[index];
          const end = sectorAngles[index + 1];

          const margin = 3;
          const minA = start + margin;
          const maxA = end - margin;

          const originalAngle = minA + Math.random() * (maxA - minA);

          const currentMod = ((currentRotation % 360) + 360) % 360;
          const desiredMod = (pointerAngle - originalAngle + 360) % 360;

          const newRotation =
            currentRotation +
            (360 * 3 * seed) +
            ((desiredMod - currentMod + 360) % 360);

          currentRotation = newRotation;

          wheel.style.transition = "transform 2.4s cubic-bezier(0.22, 0.61, 0.35, 1)";
          wheel.style.transform = `rotate(${newRotation}deg)`;

          setTimeout(() => {
            isSpinning = false;

            const chosen = whichPrizeByRotation(currentRotation);

            if (chosen.label === "ê½") {
              resultText.innerHTML = `ì•„ì‰½ì§€ë§Œ ì´ë²ˆì—ëŠ” <strong>ê½</strong>ì…ë‹ˆë‹¤.`;
            } else {
              resultText.innerHTML = `ì¶•í•˜í•©ë‹ˆë‹¤! <strong>${chosen.label}</strong> ë‹¹ì²¨!`;
            }

            setUIState("done");
          }, 2500);
        }

        spinButton.addEventListener("click", spinWheel);
        resetButton.addEventListener("click", resetGame);

        resetGame();
      })();
    </script>
  </body>
</html>
